version: 2

sources:
  - name: raw
    schema: gz_raw_data
    tables:
      - name: sales
        identifier: raw_gz_sales
        description: "Sales of Greenweez / one row per product_id within each order_id."
        loaded_at_field: "CAST(date_date AS TIMESTAMP)"
        freshness:
          warn_after: {count: 90, period: day}
        columns:
          - name: date_date
            description: "Date of purchase."
          - name: orders_id
            description: "Unique identifier of the order. Each order may contain multiple products."
          - name: product_id
            description: "Identifier of the product included in the order."
          - name: revenue
            description: "Total revenue generated by this product within this order (price Ã— quantity)."
          - name: quantity
            description: "Number of units of the product purchased in the order."

      - name: product
        identifier: raw_gz_product
        description: "Cleaned and standardized product data coming from the raw Greenweez dataset."
        columns:
          - name: products_id
            description: "Unique identifier of the product."
            tests:
            - unique
            - not_null
          - name: purchase_price
            description: "The purchase cost of the product, converted to FLOAT format."

      - name: ship
        identifier: raw_gz_ship
        description: "Cleaned shipping and logistics cost data associated with each order."
        columns:
          - name: orders_id
            description: "Identifier of the order for which the shipping and logistics costs apply."
            tests:
            - unique
            - not_null
          - name: shipping_fee
            description: "Shipping fee charged to the customer for this order."
          - name: log_cost
            description: "Internal logistics cost incurred to prepare and handle the order."
          - name: ship_cost
            description: "Total shipping cost paid by the company, converted to a numeric value in the staging layer."